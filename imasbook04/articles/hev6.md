# FPGAでモテモテなハッピーライフをエンジョイしようよ！　by へヴろく


## ねぇねぇ！プロデューサーさん、今日は一日中おしゃべりしたいな～、ダメ？


## もくじ

FPGAのすすめ

コーディングのお作法だよ

765カウンタをつくってみよう

※若葉マークのみんな（自分）向けの記事です。


### FPGAのすすめ
 みなさん！FPGA使ってますか？？最近話題の例のアレです。  FPGA:言語ベースで回路を構成し所望の動作をさせることができるデバイス。  最近はARMのコアとHBMメモリーを搭載したりしていろいろ良くわかりません。

 「FPGAは難しいよー。ラズパイじゃだめなの？」

 最初は自分もそう思っていました。FPGAはフルに使いこなそうとすると難しいですしお金もかかります。でもちょっとしたものなら簡単に無料で作ることができますので、用途に合わせて選択して欲しいと思います。

 「なんでFPGAなの？」

 　リアルタイムに処理ができる事につきます。ここのリアルタイムというのがミソで、ピコ秒オーダーでのタイミング調整ができますので、めちゃ速く動かすことができます。


 
### コーディングのお作法だよ
 コーディングの言語としてはVerilog HDL（以下Verilog）で回路を記述すれば間違いないので、これから覚えるよって人はVerilogの文法を覚えましょう。この記事では回路ベースの書き方を説明します。

コメントは「//」か「/* */」で囲う
とにかくコメントは書きましょう、可読性が下がるとか見ればわかるとかはスルーしましょう。

１ソース１モジュールを守ろう
１つのソースにだらだらと全機能を書くのはやめたほうがいいです。さもなくばシミュレーションまではうまくいってもいざ回路に落とし込む場合に謎のエラーに悩まされるでしょう。




### 765カウンタをつくってみよう
 よくあるカウンタを765仕様でつくってみよう！
部品
Zynq-7000評価ボード
7セグメントLED　3個
電流制限抵抗

　仕様
右：0→5
中：0→6
左：0→7
右が5までカウントアップしたら桁上げして、中を6までカウントアップしたら、左を7までカウントアップして「765」を約1秒周期で点滅。
これを繰り返す。リセットとしてSW0を割り当てる。ONでリセットし0点滅、OFFで上記「765」カウントする。

7セグメントLED仕様
  A,B,C,D,E,F,G
0=A,B,C,D,E,F : 7'b1111110
1=B,C         : 7'b0110000
2=A,B,D,E,G   : 7'b1101101
3=A,B,C,D,G   : 7'b1111001
4=B,C,F,G     : 7'b0110011
5=A,C,D,F,G   : 7'b1011011
6=A,C,D,E,F,G : 7'b1011111
7=A,B,C     　: 7'b1110000

ブロック図


### コーディングする




### らくらくシミュレーション
回路のコーディングが終わったらつぎはシミュレーションプログラムをコーディングします。俗にいうテストベンチと呼ばれるものです。



### 開発環境のインストール
Xilinxのハードウェア開発ツールとしてVivadoがありますので、これをPCにインストールします。
使用できるデバイスは制限されますが、ほぼすべての機能が利用できるWebPackのライセンスで使います。

ホストOS Windows10 64bit 
開発ツール Vivado 2019.1

オペレーションフロー
プロジェクトの新規作成→RTLデザイン→さっきのソースを指定。


### ハードウェアの準備

Xilinx Zynq-7000シリーズの開発ボードDigilent ZYBOで動かしてみましょう。

いずれの場合も使うピンは制約ファイル(ZYBO_Master.xdc)でコメントアウトを解除してください。
ネット名を合わせるのもお忘れなく！

### 動かしてみる



### おわりに

## プロデューサーさんって、FPGAだーいすきですよね。私も気に入っちゃったかも！